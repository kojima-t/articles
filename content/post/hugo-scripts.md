+++
date = "2017-02-27T00:18:19+09:00"
title = "Hugoの操作補助スクリプトをRubyで書く。"
draft = false
tags = ["Ruby"]
+++

## Hugo の操作を Ruby で行う

静的サイトジェネレータのよいところといえばコマンドラインで操作を完結できるところでしょう。
そんなわけで、静的サイトジェネレータ Hugo の操作を補助する Ruby スクリプトを書いていました。仕事でもコードばかり書いているのに、休日も結局コードを書いていてしまいますね。

ファイルは[こちら](https://github.com/kojima-t/utilities/blob/master/my-hugo.rb)ですが、そのうち Gist にうつすか、大きくなったら単一リポジトリにするかしようかと思っています。

あと、 `my-hugo` という名前もダサいのでなんとかしたい。

あくまでもユーティリティなので、あまり思想とかはありません。自分が Hugo を操作する上で「やりたいな」と思うことを実装する、という感覚で今は作っています。

多機能なコマンドにしたいので、

* コマンドラインオプションで多機能化
* サブコマンドで多機能化

をとりあえず考えたのですが、今回は前者でやりました。というのは過去に `optparse` を使用したことがあったのと、そんなに大きなスクリプトにするつもりは今のところないので。

ただ、サブコマンドのほうが良いかもしれないですね。 オプションだと複数のオプションが true のときの処理とかを真面目に考えると大変になりそうですし、このコマンドは複数オプションの指定をするメリットがあまりないので。

## 現状

ひとまず、次のような機能を実装してみました。

```
% my-hugo --help
Usage: my-hugo [options]
    -d, --deploy                     GitHub Pages に deploy
    -a, --add                        記事を content/post ディレクトリに追加、編集用にエディタを開く。
    -u, --undraft                    指定した記事を下書きから外す。
    -w, --watch                      プレビューサーバーを起動する。
        --daemon                     プレビューサーバーのデーモン化
    -l, --list-files                 content/post ディレクトリのファイルを表示
```

`-d` は GitHub Pagesに自動pushをするコマンドです。プレビューサーバーを起動するのは `-w`、デーモン化して起動するのは `--daemon`。 新規記事の追加、 既存記事の編集は `-a`、下書きを外すのは `-u`。既存記事一覧は `-l` です。

たとえば、記事の日付やタグを用いて、記事をフィルタリングしたりするコマンドなんかもあると嬉しいですね。

あと、現在ブログパスをコードに直接書かないといけないので、ブログのパスを設定するインターフェースを作らないといけないですね。 `$XDG_CONFIG/my-hugo/config.json` とかに書き込むようにしようかと思っていますが。

あと、今は起動エディタを Atom のみにしていますが、 `vim`、 `emacs`、 `nano`、なんでもいいですが他のものも起動できるようにしたいですね。

## TODO

- [ ] ファイル名による検索機能の実装。
- [ ] 検索機能の強化
- [ ] ブログパスの設定インターフェースを実装、改良
- [ ] Atom 以外のエディタでも編集できるようにする。
